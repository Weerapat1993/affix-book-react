import{r as C,a8 as H,W as M,j as e,B as A,Y as V}from"./app-CV9A9Knv.js";import{A as W}from"./AuthenticatedLayout-lCtMtmb_.js";import{C as $}from"./Card-CaPknzqU.js";import{A as K,C as O}from"./AdminHeader-CwBm9lbR.js";import{c as w,d as Y,e as U,u as q,S as G,f as J,h as k,i as Q}from"./FooterLayout-DlX_7gvg.js";import{F as _}from"./index-5RiR6D2o.js";import{F as X}from"./Table-Da-91tPc.js";import{F as Z}from"./ApplicationLogo-CrVoc7yY.js";import{R as ee}from"./DeleteOutlined-DCvoU7na.js";import"./index-pTK18D2Z.js";import"./addEventListener-B42ZgBRq.js";import"./index-sZf9PeB6.js";import"./scrollTo-DwBBsVjo.js";import"./index-BIzTDWqz.js";import"./EyeOutlined-B5K90arK.js";const se=i=>{const{page:a,pageSize:c,total:o}=i,p=w(t=>t.userReducer.list),l=w(t=>t.userReducer.isFetch),u=w(t=>t.userReducer.isLoading),P=w(t=>t.userReducer.error),F=Y(),[n,f]=C.useState(a),[R,j]=C.useState({current:a,pageSize:c,total:o}),m=U(n);C.useEffect(()=>{(!l||m!==n)&&g({page:n})},[m,n]);const g=async t=>{const v=await F(H(t)),{data:r}=v.payload;return j({current:(r==null?void 0:r.current_page)||1,pageSize:(r==null?void 0:r.per_page)||1,total:(r==null?void 0:r.total)||0}),v};return{list:p,pagination:R,pageState:n,isFetch:l,isLoading:u,error:P,refetch:g,setPagination:j,setPage:f}},te=i=>{const{label:a,value:c,closable:o,onClose:p}=i,l=u=>{u.preventDefault(),u.stopPropagation()};return e.jsx(k,{color:"blue",onMouseDown:l,closable:o,onClose:p,style:{marginInlineEnd:4},children:a})},re={defaultPage:1,pageSize:10,total:0,roles:[]},ae=i=>{const{isUser:a}=q(),[c]=_.useForm(),o={...re,...i},{defaultPage:p,pageSize:l,total:u,roles:P}=o,{isLoading:F,list:n,pagination:f,refetch:R,setPage:j}=se({page:p,pageSize:l,total:u}),m={user_id:0,roles:[]},{data:g,post:t,patch:v,reset:r,setData:y,processing:z,errors:ne,recentlySuccessful:b}=M(m),L=U(b),D=s=>{y("roles",s)},E=P.map(s=>({value:s,label:s}));C.useEffect(()=>{L!==b&&b&&!L&&(R({page:f.current}),y("user_id",0))},[b]);const I=async s=>{s.preventDefault(),await t(route("admin.users.sync.role"))},N=s=>{g.user_id===s?y("user_id",0):y("user_id",s)},T=[{title:"Name",dataIndex:"name",render:s=>s,width:"20%"},{title:"Email",dataIndex:"email"},{title:"Roles",key:"roles",dataIndex:"roles",render:(s,{id:h,roles:d=[]})=>e.jsx(e.Fragment,{children:g.user_id===h?e.jsx(_,{onSubmitCapture:I,form:c,initialValues:m,children:e.jsxs(G.Compact,{style:{width:"100%"},children:[e.jsx(J,{mode:"multiple",name:"roles",tagRender:te,style:{width:"100%"},defaultValue:d.map(x=>x.name),placeholder:"Roles",onChange:D,options:E}),e.jsx(A,{htmlType:"submit",disabled:z,type:"primary",children:"Save"})]})}):e.jsx(e.Fragment,{children:d.map(x=>{let S="";switch(x.name){case"admin":S="geekblue";break;case"writer":S="success";break;default:S="blue"}return e.jsx(k,{color:S,children:x.name},x.id)})})})},{title:"Action",key:"action",render:(s,h)=>{const d=a(h.id);return e.jsxs(Z,{wrap:!0,gap:"small",children:[e.jsx(A,{disabled:d,onClick:()=>N(h.id),icon:e.jsx(Q,{}),type:"primary",shape:"circle",size:"small"}),e.jsx(A,{disabled:d,icon:e.jsx(ee,{}),type:"primary",shape:"circle",size:"small",danger:!0})]})}}],B=(s,h,d)=>{Object.keys(s).length>0&&j(s.current)};return e.jsx(X,{columns:T,rowKey:s=>s.id,dataSource:n,pagination:f,loading:F,onChange:B})},oe=ae;function we({auth:i,roles:a}){const c=a.map(o=>o.name);return e.jsxs(W,{header:e.jsx("h2",{className:"font-semibold text-xl text-gray-800 dark:text-gray-200 leading-tight",children:"User List"}),children:[e.jsx(V,{title:"User List"}),e.jsx("div",{className:"py-12",children:e.jsxs("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8",children:[e.jsx(K,{}),e.jsxs($,{children:[e.jsx(O,{className:"mb-4",title:"User List"}),e.jsx(oe,{defaultPage:1,pageSize:1,roles:c})]})]})})]})}export{we as default};
