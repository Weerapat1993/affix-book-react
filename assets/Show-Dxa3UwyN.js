import{r as s,G as Z,H as I,I as be,J as ye,N as $e,L as D,ax as Se,ab as je,ae as H,F as we,j as a}from"./app-CRwb5DPf.js";import{a as Le,b as Pe}from"./laravelBlade-DnAXOTAM.js";import{F as Be,G as Y,r as Ee,S as Ne,P as Ie}from"./LayoutBreadcrumb-B8AWKc-X.js";import{I as Te}from"./index-DieUtbZg.js";import{F as ee}from"./ApplicationLogo-RDsWD0ee.js";import{e as Ae}from"./index-pTK18D2Z.js";import{g as ze,s as _e}from"./scrollTo-hje9G3B6.js";import{A as Oe}from"./index-DWiQWWG0.js";import{M as Re}from"./MangaLayout-D2UMINOE.js";import{d as Me}from"./seo-Bktiihya.js";import{S as Fe}from"./SeoHead-DPcISVAR.js";import{a as We}from"./case-6XAStsvS.js";import{u as He}from"./useWriterByUser-tQ2tOlgb.js";import{B as De}from"./BookList-38PQtHUb.js";import{C as qe}from"./index-Dbzr0D2n.js";import{F as Xe}from"./index-CJiKeHhG.js";/* empty css            */import"./createLucideIcon-DMkKqC3q.js";import"./EyeOutlined-RXfTIp3S.js";import"./addEventListener-CAQlvG5O.js";import"./index-BKNjMPK8.js";import"./index.es-VBRgfGMV.js";import"./DeleteOutlined-BdtmIoRm.js";import"./index-CDM5uUcF.js";import"./PlusOutlined-5Xeku6ay.js";const te=s.createContext(void 0),ne=t=>{const{href:e,title:o,prefixCls:d,children:l,className:u,target:i,replace:c}=t,g=s.useContext(te),{registerLink:C,unregisterLink:b,scrollTo:p,onClick:y,activeLink:m,direction:w}=g||{};s.useEffect(()=>(C==null||C(e),()=>{b==null||b(e)}),[e]);const $=S=>{y==null||y(S,{title:o,href:e}),p==null||p(e),c&&(S.preventDefault(),window.location.replace(e))},{getPrefixCls:x}=s.useContext(Z),h=x("anchor",d),T=m===e,P=I(`${h}-link`,u,{[`${h}-link-active`]:T}),A=I(`${h}-link-title`,{[`${h}-link-title-active`]:T});return s.createElement("div",{className:P},s.createElement("a",{className:A,href:e,title:typeof o=="string"?o:"",target:i,onClick:$},o),w!=="horizontal"?l:null)},Ve=t=>{const{componentCls:e,holderOffsetBlock:o,motionDurationSlow:d,lineWidthBold:l,colorPrimary:u,lineType:i,colorSplit:c,calc:g}=t;return{[`${e}-wrapper`]:{marginBlockStart:g(o).mul(-1).equal(),paddingBlockStart:o,[e]:Object.assign(Object.assign({},$e(t)),{position:"relative",paddingInlineStart:l,[`${e}-link`]:{paddingBlock:t.linkPaddingBlock,paddingInline:`${D(t.linkPaddingInlineStart)} 0`,"&-title":Object.assign(Object.assign({},Se),{position:"relative",display:"block",marginBlockEnd:t.anchorTitleBlock,color:t.colorText,transition:`all ${t.motionDurationSlow}`,"&:only-child":{marginBlockEnd:0}}),[`&-active > ${e}-link-title`]:{color:t.colorPrimary},[`${e}-link`]:{paddingBlock:t.anchorPaddingBlockSecondary}}}),[`&:not(${e}-wrapper-horizontal)`]:{[e]:{"&::before":{position:"absolute",insetInlineStart:0,top:0,height:"100%",borderInlineStart:`${D(l)} ${i} ${c}`,content:'" "'},[`${e}-ink`]:{position:"absolute",insetInlineStart:0,display:"none",transform:"translateY(-50%)",transition:`top ${d} ease-in-out`,width:l,backgroundColor:u,[`&${e}-ink-visible`]:{display:"inline-block"}}}},[`${e}-fixed ${e}-ink ${e}-ink`]:{display:"none"}}}},Ge=t=>{const{componentCls:e,motionDurationSlow:o,lineWidthBold:d,colorPrimary:l}=t;return{[`${e}-wrapper-horizontal`]:{position:"relative","&::before":{position:"absolute",left:{_skip_check_:!0,value:0},right:{_skip_check_:!0,value:0},bottom:0,borderBottom:`${D(t.lineWidth)} ${t.lineType} ${t.colorSplit}`,content:'" "'},[e]:{overflowX:"scroll",position:"relative",display:"flex",scrollbarWidth:"none","&::-webkit-scrollbar":{display:"none"},[`${e}-link:first-of-type`]:{paddingInline:0},[`${e}-ink`]:{position:"absolute",bottom:0,transition:`left ${o} ease-in-out, width ${o} ease-in-out`,height:d,backgroundColor:l}}}}},Je=t=>({linkPaddingBlock:t.paddingXXS,linkPaddingInlineStart:t.padding}),Ue=be("Anchor",t=>{const{fontSize:e,fontSizeLG:o,paddingXXS:d,calc:l}=t,u=ye(t,{holderOffsetBlock:d,anchorPaddingBlockSecondary:l(d).div(2).equal(),anchorTitleBlock:l(e).div(14).mul(3).equal(),anchorBallSize:l(o).div(2).equal()});return[Ve(u),Ge(u)]},Je);function Ye(){return window}function K(t,e){if(!t.getClientRects().length)return 0;const o=t.getBoundingClientRect();return o.width||o.height?e===window?o.top-t.ownerDocument.documentElement.clientTop:o.top-e.getBoundingClientRect().top:o.top}const Q=/#([\S ]+)$/,Ke=t=>{var e;const{rootClassName:o,prefixCls:d,className:l,style:u,offsetTop:i,affix:c=!0,showInkInFixed:g=!1,children:C,items:b,direction:p="vertical",bounds:y,targetOffset:m,onClick:w,onChange:$,getContainer:x,getCurrentAnchor:h,replace:T}=t,[P,A]=s.useState([]),[S,ie]=s.useState(null),z=s.useRef(S),q=s.useRef(null),_=s.useRef(null),O=s.useRef(!1),{direction:se,anchor:B,getTargetContainer:re,getPrefixCls:ae}=s.useContext(Z),v=ae("anchor",d),X=je(v),[le,ce,de]=Ue(v,X),E=(e=x??re)!==null&&e!==void 0?e:Ye,R=JSON.stringify(P),ue=H(n=>{P.includes(n)||A(r=>[].concat(we(r),[n]))}),pe=H(n=>{P.includes(n)&&A(r=>r.filter(k=>k!==n))}),ge=()=>{var n;const r=(n=q.current)===null||n===void 0?void 0:n.querySelector(`.${v}-link-title-active`);if(r&&_.current){const{style:k}=_.current,f=p==="horizontal";k.top=f?"":`${r.offsetTop+r.clientHeight/2}px`,k.height=f?"":`${r.clientHeight}px`,k.left=f?`${r.offsetLeft}px`:"",k.width=f?`${r.clientWidth}px`:"",f&&Ae(r,{scrollMode:"if-needed",block:"nearest"})}},fe=function(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,k=arguments.length>2&&arguments[2]!==void 0?arguments[2]:5;const f=[],W=E();return n.forEach(L=>{const j=Q.exec(L==null?void 0:L.toString());if(!j)return;const N=document.getElementById(j[1]);if(N){const U=K(N,W);U<=r+k&&f.push({link:L,top:U})}}),f.length?f.reduce((j,N)=>N.top>j.top?N:j).link:""},M=H(n=>{if(z.current===n)return;const r=typeof h=="function"?h(n):n;ie(r),z.current=r,$==null||$(n)}),F=s.useCallback(()=>{if(O.current)return;const n=fe(P,m!==void 0?m:i||0,y);M(n)},[R,m,i]),V=s.useCallback(n=>{M(n);const r=Q.exec(n);if(!r)return;const k=document.getElementById(r[1]);if(!k)return;const f=E(),W=ze(f),L=K(k,f);let j=W+L;j-=m!==void 0?m:i||0,O.current=!0,_e(j,{getContainer:E,callback(){O.current=!1}})},[m,i]),me=I(ce,de,X,o,`${v}-wrapper`,{[`${v}-wrapper-horizontal`]:p==="horizontal",[`${v}-rtl`]:se==="rtl"},l,B==null?void 0:B.className),he=I(v,{[`${v}-fixed`]:!c&&!g}),ke=I(`${v}-ink`,{[`${v}-ink-visible`]:S}),ve=Object.assign(Object.assign({maxHeight:i?`calc(100vh - ${i}px)`:"100vh"},B==null?void 0:B.style),u),G=n=>Array.isArray(n)?n.map(r=>s.createElement(ne,Object.assign({replace:T},r,{key:r.key}),p==="vertical"&&G(r.children))):null,J=s.createElement("div",{ref:q,className:me,style:ve},s.createElement("div",{className:he},s.createElement("span",{className:ke,ref:_}),"items"in t?G(b):C));s.useEffect(()=>{const n=E();return F(),n==null||n.addEventListener("scroll",F),()=>{n==null||n.removeEventListener("scroll",F)}},[R]),s.useEffect(()=>{typeof h=="function"&&M(h(z.current||""))},[h]),s.useEffect(()=>{ge()},[p,h,R,S]);const xe=s.useMemo(()=>({registerLink:ue,unregisterLink:pe,scrollTo:V,activeLink:S,onClick:w,direction:p}),[S,w,V,p]),Ce=c&&typeof c=="object"?c:void 0;return le(s.createElement(te.Provider,{value:xe},c?s.createElement(Oe,Object.assign({offsetTop:i,target:E},Ce),J):J))},oe=Ke;oe.Link=ne;const Qe=({list:t})=>{const[e,o]=s.useState(2),d=t.length,l=t.slice(0,e).map(i=>({key:`page-${i.page}`,href:`#page-${i.page}`,title:" "})),u=s.useCallback(i=>{const c=parseInt(i.slice(6));c>e-5&&o(c+5)},[e]);return a.jsxs(Be,{className:"mt-4",children:[a.jsx(Y,{span:23,children:t.slice(0,e).map(i=>a.jsx("div",{id:`page-${i.page}`,className:"text-center",children:i.page<e?a.jsxs(s.Fragment,{children:[a.jsx(Te,{preview:!1,alt:`Page ${i.page}`,src:Le(`storage/chapter-pages/${i.img_url}`),fallback:Pe,className:"w-screen h-screen object-cover object-center",loading:"lazy"}),a.jsx("div",{className:"my-4",children:a.jsxs(Ee,{className:"font-bold",color:"blue-inverse",children:["Page ",i.page,"/",d]})})]}):a.jsx(ee,{justify:"center",align:"middle",style:{height:Math.floor(i.height/2)},children:a.jsx(Ne,{size:"large"})})},i.id))}),a.jsx(Y,{className:"hidden sm:block",span:1,children:a.jsx(oe,{replace:!0,offsetTop:70,items:l,onChange:u})})]})},Ze=Qe,et=({userId:t,bookId:e})=>{const{pagination:o,page:d,list:l,isLoading:u,setWriterPage:i}=He({userId:t}),c=g=>{i(g)};return a.jsxs(a.Fragment,{children:[a.jsx(ee,{justify:"end",gap:"small",className:"my-4",children:o!=null&&o.total?a.jsx(Ie,{current:d,onChange:c,total:o.total,defaultPageSize:o.pageSize,align:"end"}):null}),a.jsx(qe,{children:a.jsx(De,{isLoading:u,list:l.filter(g=>g.id!==e)})})]})},tt=et;function Lt({auth:t,chapter:e,allChapterList:o}){var i,c,g,C,b,p,y,m,w,$;const d=`/storage/${(g=(c=(i=e.pages)==null?void 0:i.filter(x=>x.page===1))==null?void 0:c[0])==null?void 0:g.img_url}`,l={title:`Chapter ${e.chapter} : ${e.title} - Affixbook.net | เว็บไซต์อ่านหนังสือออนไลน์`,description:((C=e.book)==null?void 0:C.synopsis)||Me.description,keywords:(((b=e.book)==null?void 0:b.categories)||[]).map(x=>x.name),author:"",canonical:route("chapters.show",e.slug),image:d},u=[{key:1,title:"Home",href:route("home")},{key:2,title:(p=e.book)==null?void 0:p.type,href:route(`books.${We(((y=e.book)==null?void 0:y.type)||"")}`)},{key:3,title:(m=e.book)==null?void 0:m.title,href:route("books.show",(w=e.book)==null?void 0:w.id),isLinkLast:!0}];return a.jsxs(Re,{title:(($=e==null?void 0:e.book)==null?void 0:$.title)||"",user:t.user,bookId:e.book_id,defaultChapter:e.chapter,list:o||[],breadcrumbs:u,children:[a.jsx(Fe,{meta:l}),a.jsxs("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8 pb-12",children:[a.jsx(Ze,{list:e.pages||[]}),a.jsx(tt,{userId:e.user_id,bookId:e.book_id}),a.jsx(Xe.BackTop,{})]})]})}export{Lt as default};
