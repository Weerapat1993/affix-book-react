import{r as g,X as N,y as D,ac as T,ad as E,ae as O,af as $,ag as z,j as a,a9 as H,B}from"./app-CV9A9Knv.js";import{A as W}from"./AuthenticatedLayout-lCtMtmb_.js";import{B as X}from"./BookList-CMt_nM24.js";import{c as d,d as _,e as R,u as q,D as G}from"./FooterLayout-DlX_7gvg.js";import{C as J}from"./CategoryFilter-B0w9D-Yb.js";import{d as v}from"./seo-Bktiihya.js";import{a as K,F as Q}from"./ApplicationLogo-CrVoc7yY.js";import{S as U}from"./SeoHead-BkwZTYew.js";import{R as V}from"./PlusOutlined-BID3IEi_.js";import{F as Y}from"./index-ceaKtghh.js";import"./index-Crwc0KU0.js";import"./index-HJuJD2XC.js";import"./EyeOutlined-B5K90arK.js";import"./addEventListener-B42ZgBRq.js";import"./scrollTo-DwBBsVjo.js";var Z={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M909.1 209.3l-56.4 44.1C775.8 155.1 656.2 92 521.9 92 290 92 102.3 279.5 102 511.5 101.7 743.7 289.8 932 521.9 932c181.3 0 335.8-115 394.6-276.1 1.5-4.2-.7-8.9-4.9-10.3l-56.7-19.5a8 8 0 00-10.1 4.8c-1.8 5-3.8 10-5.9 14.9-17.3 41-42.1 77.8-73.7 109.4A344.77 344.77 0 01655.9 829c-42.3 17.9-87.4 27-133.8 27-46.5 0-91.5-9.1-133.8-27A341.5 341.5 0 01279 755.2a342.16 342.16 0 01-73.7-109.4c-17.9-42.4-27-87.4-27-133.9s9.1-91.5 27-133.9c17.3-41 42.1-77.8 73.7-109.4 31.6-31.6 68.4-56.4 109.3-73.8 42.3-17.9 87.4-27 133.8-27 46.5 0 91.5 9.1 133.8 27a341.5 341.5 0 01109.3 73.8c9.9 9.9 19.2 20.4 27.8 31.4l-60.2 47a8 8 0 003 14.1l175.6 43c5 1.2 9.9-2.6 9.9-7.7l.8-180.9c-.1-6.6-7.8-10.3-13-6.2z"}}]},name:"reload",theme:"outlined"},ee=function(p,u){return g.createElement(N,D({},p,{ref:u,icon:Z}))},se=g.forwardRef(ee);const te=({key:o,flash:p})=>{const{message:u}=T.useApp(),b=d(e=>{var t,s;return(s=(t=e.bookReducer.keys)==null?void 0:t[o])==null?void 0:s.isLoading}),x=d(e=>{var t,s;return(s=(t=e.bookReducer.keys)==null?void 0:t[o])==null?void 0:s.isFetch}),P=d(e=>{var t,s;return(s=(t=e.bookReducer.keys)==null?void 0:t[o])==null?void 0:s.error}),n=d(e=>{var t,s;return(s=(t=e.bookReducer.keys)==null?void 0:t[o])==null?void 0:s.filters.categoryIds}),c=d(e=>{var t,s;return(s=(t=e.bookReducer.keys)==null?void 0:t[o])==null?void 0:s.pagination}),i=d(e=>{var t,s;return(s=(t=e.bookReducer.keys)==null?void 0:t[o])==null?void 0:s.pages}),r=d(e=>{var t,s;return(s=(t=e.bookReducer.keys)==null?void 0:t[o])==null?void 0:s.pagination.page}),l=_(),m=(n||[]).toString(),h=R(r),j=R(m),k=g.useMemo(()=>{let e=[];const t=(c==null?void 0:c.page)||1;for(let s=0;s<t;s++){const w=(i==null?void 0:i[s+1])||[];e=[...e,...w]}return e},[i]),y=h!==r&&h!==void 0,C=j!==m&&j!==void 0,F=!(i!=null&&i[r]);g.useEffect(()=>{p==="refetch"?(u.success("Success"),f({key:o,categoryIds:n,page:r||1})):x?y&&F?f({key:o,categoryIds:n,page:r||1}):C&&r!==1?A(1):C&&r===1&&f({key:o,categoryIds:n,page:r}):f({key:o,categoryIds:n,page:r||1})},[o,r,m,p]);const f=async e=>await l(E(e)),I=g.useCallback(e=>{l(O({key:o,categoryIds:e}))},[o]),L=g.useCallback(e=>{l($({key:o,page:e}))},[o]),A=g.useCallback(e=>{l(z({key:o,page:e}))},[o]),S=k||[],M=(c==null?void 0:c.lastPage)||1;return{page:r,isLoading:b,isFetch:x,list:S,error:P,pagination:c,refetch:f,categoryIds:n||[],lastPage:M,setBookPage:L,setBookFilterCategory:I}},oe={currentPage:1,pageSize:12,total:0};function ye(o){const p={...oe,...o},{title:u,categories:b,type:x,flash:P}=p,{isRole:n}=q(),{list:c,isLoading:i,lastPage:r,page:l,setBookPage:m,categoryIds:h,setBookFilterCategory:j}=te({key:x,flash:P.message}),k=()=>{m(l+1)},y=l>=r,C={title:`${u} - ${v.title}`,description:v.description,keywords:["Book","Manga","Novel","Comic","Oneshot"],author:"",canonical:K(route("books.manga"))};return a.jsxs(W,{header:a.jsx("h2",{className:"font-semibold text-xl text-gray-800 dark:text-gray-200 leading-tight",children:u}),actions:n("writer")?a.jsx(H,{href:route("books.create"),children:a.jsx(B,{size:"small",type:"primary",icon:a.jsx(V,{}),children:"Create"})}):null,children:[a.jsx(U,{meta:C}),a.jsx("div",{className:"pt-4 pb-12",children:a.jsxs("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8",children:[a.jsx(J,{value:h,list:b,onChange:j}),a.jsx(G,{}),a.jsx(X,{list:c}),y?null:a.jsx(Q,{className:"my-4",justify:"center",gap:"small",children:a.jsx(B,{type:"primary",onClick:k,icon:a.jsx(se,{}),loading:i,disabled:y,children:"Load More"})}),a.jsx(Y.BackTop,{})]})})]})}export{ye as default};
