import{I as ne,q as o,G as re,H as b,T as ie}from"./app-BFpxoxyw.js";import{b as z}from"./FooterLayout-D0PuD2DU.js";import{t as F}from"./index-B3kstpWx.js";const se=r=>{const{componentCls:c}=r;return{[c]:{position:"fixed",zIndex:r.zIndexPopup}}},ce=r=>({zIndexPopup:r.zIndexBase+10}),ae=ne("Affix",se,ce);function x(r){return r!==window?r.getBoundingClientRect():{top:0,bottom:window.innerHeight}}function L(r,c,i){if(i!==void 0&&Math.round(c.top)>Math.round(r.top)-i)return i+c.top}function _(r,c,i){if(i!==void 0&&Math.round(c.bottom)<Math.round(r.bottom)+i){const S=window.innerHeight-c.bottom;return i+S}}const B=["resize","scroll","touchstart","touchmove","touchend","pageshow","load"];function le(){return typeof window<"u"?window:null}const H=0,M=1,he=o.forwardRef((r,c)=>{var i;const{style:S,offsetTop:w,offsetBottom:m,prefixCls:O,className:G,rootClassName:U,children:V,target:l,onChange:R}=r,{getPrefixCls:X,getTargetContainer:j}=o.useContext(re),T=X("affix",O),[k,q]=o.useState(!1),[a,D]=o.useState(),[J,K]=o.useState(),y=o.useRef(H),E=o.useRef(null),f=o.useRef(),d=o.useRef(null),C=o.useRef(null),v=o.useRef(null),s=(i=l??j)!==null&&i!==void 0?i:le,A=m===void 0&&w===void 0?0:w,Q=()=>{if(y.current!==M||!C.current||!d.current||!s)return;const n=s();if(n){const t={status:H},e=x(d.current);if(e.top===0&&e.left===0&&e.width===0&&e.height===0)return;const h=x(n),p=L(e,h,A),P=_(e,h,m);p!==void 0?(t.affixStyle={position:"fixed",top:p,width:e.width,height:e.height},t.placeholderStyle={width:e.width,height:e.height}):P!==void 0&&(t.affixStyle={position:"fixed",bottom:P,width:e.width,height:e.height},t.placeholderStyle={width:e.width,height:e.height}),t.lastAffix=!!t.affixStyle,k!==t.lastAffix&&(R==null||R(t.lastAffix)),y.current=t.status,D(t.affixStyle),K(t.placeholderStyle),q(t.lastAffix)}},I=()=>{y.current=M,Q()},u=F(()=>{I()}),g=F(()=>{if(s&&a){const n=s();if(n&&d.current){const t=x(n),e=x(d.current),h=L(e,t,A),p=_(e,t,m);if(h!==void 0&&a.top===h||p!==void 0&&a.bottom===p)return}}I()}),N=()=>{const n=s==null?void 0:s();n&&(B.forEach(t=>{var e;f.current&&((e=E.current)===null||e===void 0||e.removeEventListener(t,f.current)),n==null||n.addEventListener(t,g)}),E.current=n,f.current=g)},W=()=>{v.current&&(clearTimeout(v.current),v.current=null);const n=s==null?void 0:s();B.forEach(t=>{var e;n==null||n.removeEventListener(t,g),f.current&&((e=E.current)===null||e===void 0||e.removeEventListener(t,f.current))}),u.cancel(),g.cancel()};o.useImperativeHandle(c,()=>({updatePosition:u})),o.useEffect(()=>(v.current=setTimeout(N),()=>W()),[]),o.useEffect(()=>{N()},[l,a]),o.useEffect(()=>{u()},[l,w,m]);const[Y,Z,$]=ae(T),ee=b(U,Z,T,$),te=b({[ee]:a});let oe=ie(r,["prefixCls","offsetTop","offsetBottom","target","onChange","rootClassName"]);return Y(o.createElement(z,{onResize:u},o.createElement("div",Object.assign({style:S,className:G,ref:d},oe),a&&o.createElement("div",{style:J,"aria-hidden":"true"}),o.createElement("div",{className:te,ref:C,style:a},o.createElement(z,{onResize:u},V)))))});export{he as A};
