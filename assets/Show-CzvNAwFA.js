import{r as s,G as Z,H as I,I as be,J as ye,N as $e,L as D,ax as Se,ab as je,ae as H,F as we,j as l}from"./app-Dg8HGri5.js";import{a as Le,b as Pe}from"./laravelBlade-DnAXOTAM.js";import{F as Be,G as Y,r as Ee,S as Ne,P as Ie}from"./LayoutBreadcrumb-FYt7O-h6.js";import{I as Te}from"./index-Bz-I84Jn.js";import{F as ee}from"./ApplicationLogo-CaO9lwQU.js";import{e as Ae}from"./index-pTK18D2Z.js";import{g as _e,s as ze}from"./scrollTo-B9OUNoJo.js";import{A as Oe}from"./index-FF5z00PN.js";import{M as Re}from"./MangaLayout-B2SwJ2Nm.js";import{d as Me}from"./seo-Bktiihya.js";import{S as Fe}from"./SeoHead-Cu8ZV6Nq.js";import{a as We}from"./case-C42xd7B6.js";import{u as He}from"./useWriterByUser-ByhQEdge.js";import{B as De}from"./BookList-DraY5_5E.js";import{C as qe}from"./index-C7eIKsZe.js";import{F as Xe}from"./index-DnLnJen6.js";/* empty css            */import"./createLucideIcon-BUZvSNL_.js";import"./EyeOutlined-CuFUm0zo.js";import"./addEventListener-DiZ7j4_m.js";import"./index-BKNjMPK8.js";import"./index.es-meiEWiaN.js";import"./DeleteOutlined-CFDSNr_L.js";import"./index-OyMa-O9O.js";import"./PlusOutlined-8VTVOCcu.js";const te=s.createContext(void 0),oe=t=>{const{href:e,title:n,prefixCls:d,children:a,className:u,target:i,replace:c}=t,f=s.useContext(te),{registerLink:C,unregisterLink:b,scrollTo:g,onClick:y,activeLink:p,direction:w}=f||{};s.useEffect(()=>(C==null||C(e),()=>{b==null||b(e)}),[e]);const $=S=>{y==null||y(S,{title:n,href:e}),g==null||g(e),c&&(S.preventDefault(),window.location.replace(e))},{getPrefixCls:x}=s.useContext(Z),k=x("anchor",d),T=p===e,P=I(`${k}-link`,u,{[`${k}-link-active`]:T}),A=I(`${k}-link-title`,{[`${k}-link-title-active`]:T});return s.createElement("div",{className:P},s.createElement("a",{className:A,href:e,title:typeof n=="string"?n:"",target:i,onClick:$},n),w!=="horizontal"?a:null)},Ve=t=>{const{componentCls:e,holderOffsetBlock:n,motionDurationSlow:d,lineWidthBold:a,colorPrimary:u,lineType:i,colorSplit:c,calc:f}=t;return{[`${e}-wrapper`]:{marginBlockStart:f(n).mul(-1).equal(),paddingBlockStart:n,[e]:Object.assign(Object.assign({},$e(t)),{position:"relative",paddingInlineStart:a,[`${e}-link`]:{paddingBlock:t.linkPaddingBlock,paddingInline:`${D(t.linkPaddingInlineStart)} 0`,"&-title":Object.assign(Object.assign({},Se),{position:"relative",display:"block",marginBlockEnd:t.anchorTitleBlock,color:t.colorText,transition:`all ${t.motionDurationSlow}`,"&:only-child":{marginBlockEnd:0}}),[`&-active > ${e}-link-title`]:{color:t.colorPrimary},[`${e}-link`]:{paddingBlock:t.anchorPaddingBlockSecondary}}}),[`&:not(${e}-wrapper-horizontal)`]:{[e]:{"&::before":{position:"absolute",insetInlineStart:0,top:0,height:"100%",borderInlineStart:`${D(a)} ${i} ${c}`,content:'" "'},[`${e}-ink`]:{position:"absolute",insetInlineStart:0,display:"none",transform:"translateY(-50%)",transition:`top ${d} ease-in-out`,width:a,backgroundColor:u,[`&${e}-ink-visible`]:{display:"inline-block"}}}},[`${e}-fixed ${e}-ink ${e}-ink`]:{display:"none"}}}},Ge=t=>{const{componentCls:e,motionDurationSlow:n,lineWidthBold:d,colorPrimary:a}=t;return{[`${e}-wrapper-horizontal`]:{position:"relative","&::before":{position:"absolute",left:{_skip_check_:!0,value:0},right:{_skip_check_:!0,value:0},bottom:0,borderBottom:`${D(t.lineWidth)} ${t.lineType} ${t.colorSplit}`,content:'" "'},[e]:{overflowX:"scroll",position:"relative",display:"flex",scrollbarWidth:"none","&::-webkit-scrollbar":{display:"none"},[`${e}-link:first-of-type`]:{paddingInline:0},[`${e}-ink`]:{position:"absolute",bottom:0,transition:`left ${n} ease-in-out, width ${n} ease-in-out`,height:d,backgroundColor:a}}}}},Je=t=>({linkPaddingBlock:t.paddingXXS,linkPaddingInlineStart:t.padding}),Ue=be("Anchor",t=>{const{fontSize:e,fontSizeLG:n,paddingXXS:d,calc:a}=t,u=ye(t,{holderOffsetBlock:d,anchorPaddingBlockSecondary:a(d).div(2).equal(),anchorTitleBlock:a(e).div(14).mul(3).equal(),anchorBallSize:a(n).div(2).equal()});return[Ve(u),Ge(u)]},Je);function Ye(){return window}function K(t,e){if(!t.getClientRects().length)return 0;const n=t.getBoundingClientRect();return n.width||n.height?e===window?n.top-t.ownerDocument.documentElement.clientTop:n.top-e.getBoundingClientRect().top:n.top}const Q=/#([\S ]+)$/,Ke=t=>{var e;const{rootClassName:n,prefixCls:d,className:a,style:u,offsetTop:i,affix:c=!0,showInkInFixed:f=!1,children:C,items:b,direction:g="vertical",bounds:y,targetOffset:p,onClick:w,onChange:$,getContainer:x,getCurrentAnchor:k,replace:T}=t,[P,A]=s.useState([]),[S,ie]=s.useState(null),_=s.useRef(S),q=s.useRef(null),z=s.useRef(null),O=s.useRef(!1),{direction:se,anchor:B,getTargetContainer:re,getPrefixCls:le}=s.useContext(Z),v=le("anchor",d),X=je(v),[ae,ce,de]=Ue(v,X),E=(e=x??re)!==null&&e!==void 0?e:Ye,R=JSON.stringify(P),ue=H(o=>{P.includes(o)||A(r=>[].concat(we(r),[o]))}),ge=H(o=>{P.includes(o)&&A(r=>r.filter(h=>h!==o))}),fe=()=>{var o;const r=(o=q.current)===null||o===void 0?void 0:o.querySelector(`.${v}-link-title-active`);if(r&&z.current){const{style:h}=z.current,m=g==="horizontal";h.top=m?"":`${r.offsetTop+r.clientHeight/2}px`,h.height=m?"":`${r.clientHeight}px`,h.left=m?`${r.offsetLeft}px`:"",h.width=m?`${r.clientWidth}px`:"",m&&Ae(r,{scrollMode:"if-needed",block:"nearest"})}},me=function(o){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,h=arguments.length>2&&arguments[2]!==void 0?arguments[2]:5;const m=[],W=E();return o.forEach(L=>{const j=Q.exec(L==null?void 0:L.toString());if(!j)return;const N=document.getElementById(j[1]);if(N){const U=K(N,W);U<=r+h&&m.push({link:L,top:U})}}),m.length?m.reduce((j,N)=>N.top>j.top?N:j).link:""},M=H(o=>{if(_.current===o)return;const r=typeof k=="function"?k(o):o;ie(r),_.current=r,$==null||$(o)}),F=s.useCallback(()=>{if(O.current)return;const o=me(P,p!==void 0?p:i||0,y);M(o)},[R,p,i]),V=s.useCallback(o=>{M(o);const r=Q.exec(o);if(!r)return;const h=document.getElementById(r[1]);if(!h)return;const m=E(),W=_e(m),L=K(h,m);let j=W+L;j-=p!==void 0?p:i||0,O.current=!0,ze(j,{getContainer:E,callback(){O.current=!1}})},[p,i]),pe=I(ce,de,X,n,`${v}-wrapper`,{[`${v}-wrapper-horizontal`]:g==="horizontal",[`${v}-rtl`]:se==="rtl"},a,B==null?void 0:B.className),ke=I(v,{[`${v}-fixed`]:!c&&!f}),he=I(`${v}-ink`,{[`${v}-ink-visible`]:S}),ve=Object.assign(Object.assign({maxHeight:i?`calc(100vh - ${i}px)`:"100vh"},B==null?void 0:B.style),u),G=o=>Array.isArray(o)?o.map(r=>s.createElement(oe,Object.assign({replace:T},r,{key:r.key}),g==="vertical"&&G(r.children))):null,J=s.createElement("div",{ref:q,className:pe,style:ve},s.createElement("div",{className:ke},s.createElement("span",{className:he,ref:z}),"items"in t?G(b):C));s.useEffect(()=>{const o=E();return F(),o==null||o.addEventListener("scroll",F),()=>{o==null||o.removeEventListener("scroll",F)}},[R]),s.useEffect(()=>{typeof k=="function"&&M(k(_.current||""))},[k]),s.useEffect(()=>{fe()},[g,k,R,S]);const xe=s.useMemo(()=>({registerLink:ue,unregisterLink:ge,scrollTo:V,activeLink:S,onClick:w,direction:g}),[S,w,V,g]),Ce=c&&typeof c=="object"?c:void 0;return ae(s.createElement(te.Provider,{value:xe},c?s.createElement(Oe,Object.assign({offsetTop:i,target:E},Ce),J):J))},ne=Ke;ne.Link=oe;const Qe=({list:t})=>{const[e,n]=s.useState(2),d=t.length,a=t.slice(0,e).map(i=>({key:`page-${i.page}`,href:`#page-${i.page}`,title:" "})),u=s.useCallback(i=>{const c=parseInt(i.slice(6));c>e-5&&n(c+5)},[e]);return l.jsxs(Be,{className:"mt-4",children:[l.jsx(Y,{span:23,children:t.slice(0,e).map(i=>l.jsx("div",{id:`page-${i.page}`,className:"text-center",children:i.page<e?l.jsxs(s.Fragment,{children:[l.jsx(Te,{preview:!1,alt:`Page ${i.page}`,src:Le(`storage/chapter-pages/${i.img_url}`),fallback:Pe,className:"w-screen h-screen object-cover object-center",loading:"lazy"}),l.jsx("div",{className:"my-4",children:l.jsxs(Ee,{className:"font-bold",color:"blue-inverse",children:["Page ",i.page,"/",d]})})]}):l.jsx(ee,{justify:"center",align:"middle",style:{height:Math.floor(i.height/2)},children:l.jsx(Ne,{size:"large"})})},i.id))}),l.jsx(Y,{className:"hidden sm:block",span:1,children:l.jsx(ne,{replace:!0,offsetTop:70,items:a,onChange:u})})]})},Ze=Qe,et=({userId:t,bookId:e})=>{const{pagination:n,page:d,list:a,isLoading:u,setWriterPage:i}=He({userId:t}),c=f=>{i(f)};return l.jsxs(l.Fragment,{children:[l.jsx(ee,{justify:"end",gap:"small",className:"my-4",children:n!=null&&n.total?l.jsx(Ie,{current:d,onChange:c,total:n.total,defaultPageSize:n.pageSize,align:"end"}):null}),l.jsx(qe,{children:l.jsx(De,{isLoading:u,list:a.filter(f=>f.id!==e)})})]})},tt=et;function Lt({auth:t,chapter:e,allChapterList:n}){var i,c,f,C,b,g,y,p,w,$;const d=`/storage/${(f=(c=(i=e.pages)==null?void 0:i.filter(x=>x.page===1))==null?void 0:c[0])==null?void 0:f.img_url}`,a={title:`Chapter ${e.chapter} : ${e.title} - Affixbook.net | เว็บไซต์อ่านหนังสือออนไลน์`,description:((C=e.book)==null?void 0:C.synopsis)||Me.description,keywords:(((b=e.book)==null?void 0:b.categories)||[]).map(x=>x.name),author:"",canonical:route("chapters.show",e.slug),image:d},u=[{key:1,title:"Home",href:route("home")},{key:2,title:(g=e.book)==null?void 0:g.type,href:route(`books.${We(((y=e.book)==null?void 0:y.type)||"")}`)},{key:3,title:(p=e.book)==null?void 0:p.title,href:route("books.show",(w=e.book)==null?void 0:w.id),isLinkLast:!0}];return l.jsxs(Re,{title:(($=e==null?void 0:e.book)==null?void 0:$.title)||"",user:t.user,bookId:e.book_id,defaultChapter:e.chapter,list:n||[],breadcrumbs:u,children:[l.jsx(Fe,{meta:a}),l.jsxs("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8 pb-12",children:[l.jsx(Ze,{list:(e==null?void 0:e.pages)||[]}),e!=null&&e.user_id&&(e!=null&&e.book_id)?l.jsx(tt,{userId:e==null?void 0:e.user_id,bookId:e==null?void 0:e.book_id}):null,l.jsx(Xe.BackTop,{})]})]})}export{Lt as default};
