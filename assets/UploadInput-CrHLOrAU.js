import{r as d,j as s,B as N,ab as S,a7 as j}from"./app-seHo-2Pj.js";import{d as O,a as $}from"./ApplicationLogo-Dsn01JS_.js";import{p as A,C as H}from"./FooterLayout-Vber5aYW.js";import{U as L,P as E}from"./index-q3HBubqJ.js";import{I as M}from"./index-CjLUmZqW.js";import{R as _}from"./DeleteOutlined-BRSLxfDv.js";import{s as P}from"./index-BDXsA6_q.js";import{R as D}from"./PlusOutlined-C_6t6gwO.js";var G=(e=>(e.POST="POST",e.PATCH="PATCH",e))(G||{});const J=e=>{const t=e.type==="image/jpeg"||e.type==="image/png";t||P.error("You can only upload JPG/PNG file!");const o=e.size/1024/1024<2;return o||P.error("Image must smaller than 2MB!"),t&&o},q=({onChangeUrl:e,onChangeFile:t,name:o,value:b,action:n,method:y,folderName:U})=>{const[m,u]=d.useState(0),[I,p]=d.useState(!1),[c,g]=d.useState(b),f=!!c,R=r=>{const i=r==null?void 0:r.fileList[0].originFileObj;t&&t(i)},v=()=>{g("")},w=s.jsxs("button",{style:{border:0,background:"none",width:190,height:240},type:"button",children:[I?s.jsx(S,{}):s.jsx(D,{}),s.jsx("div",{style:{marginTop:8},children:"Upload"})]}),C=async r=>{const{onSuccess:i,onError:T,file:k,onProgress:B}=r,l=new FormData,h={headers:{"content-type":"multipart/form-data"},onUploadProgress:a=>{const x=Math.floor(a.loaded/a.total*100);u(x),x===100&&setTimeout(()=>u(0),1e3),B({percent:a.loaded/a.total*100})}};l.append(o,k),l.append("folder_name",U),l.append("old_file_url",`${c}`);try{p(!0);let a;y==="PATCH"?a=await j.patch(n,l,h):a=await j.post(n,l,h),i("Ok"),g(a.data.data),e(a.data.data),p(!1)}catch(a){T({err:a}),p(!1)}};return s.jsx(A,{children:s.jsxs(H,{className:"mx-auto",children:[s.jsxs(L,{accept:"image/png, image/jpeg",customRequest:C,name:o,listType:"picture",className:"book-cover",showUploadList:!1,action:n,beforeUpload:J,onChange:R,multiple:!1,maxCount:1,children:[f?s.jsx(M,{preview:!1,fallback:O,src:$(`storage/tmp/${c}`),alt:"image",style:{width:"100%"}}):w,f?s.jsx("div",{className:"absolute top-4 right-4",children:s.jsx(N,{className:"bg-transparent hover:bg-transparent",onClick:v,icon:s.jsx(_,{}),danger:!0,type:"dashed",shape:"circle"})}):null]}),s.jsx("div",{className:"h-4",children:m>0?s.jsx(E,{percent:m}):null})]})})},Z=q;export{G as E,Z as U};
