import{r as Q,ah as ue,aR as X,W as fe,j as a,aC as z,B as R,aK as pe}from"./app-c0J2B4Ql.js";import{F as ee,A as de}from"./ApplicationLogo-D1BYlDnj.js";import{u as te,I as he,p as me,J as ve,q as ye,R as be,s as xe,T as ge,N as G,K as we}from"./FooterLayout-CVWs-C_W.js";import{p as ne}from"./index-BKNjMPK8.js";import{D as _e}from"./index-ChG_qrNu.js";import{R as je}from"./DeleteOutlined-DEf8AuyW.js";import{M as ke}from"./index-BR9FQGB2.js";var _={},A={};Object.defineProperty(A,"__esModule",{value:!0});var Se=function(){function n(e,r){for(var o=0;o<r.length;o++){var t=r[o];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}return function(e,r,o){return r&&n(e.prototype,r),o&&n(e,o),e}}(),re=Q,F=U(re),Te=ue,Oe=U(Te),Pe=ne,b=U(Pe);function U(n){return n&&n.__esModule?n:{default:n}}function Ee(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function J(n,e){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:n}function De(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);n.prototype=Object.create(e&&e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(n,e):n.__proto__=e)}var M=function(n){De(e,n);function e(){var r,o,t,i;Ee(this,e);for(var c=arguments.length,p=Array(c),u=0;u<c;u++)p[u]=arguments[u];return i=(o=(t=J(this,(r=e.__proto__||Object.getPrototypeOf(e)).call.apply(r,[this].concat(p))),t),t.state={isSticky:!1,wasSticky:!1,style:{}},t.handleContainerEvent=function(f){var d=f.distanceFromTop,l=f.distanceFromBottom,v=f.eventSource,h=t.context.getParent(),x=!1;t.props.relative&&(x=v!==h,d=-(v.scrollTop+v.offsetTop)+t.placeholder.offsetTop);var D=t.placeholder.getBoundingClientRect(),N=t.content.getBoundingClientRect(),g=N.height,k=l-t.props.bottomOffset-g,S=!!t.state.isSticky,s=x?S:d<=-t.props.topOffset&&l>-t.props.bottomOffset;l=(t.props.relative?h.scrollHeight-h.scrollTop:l)-g;var T=s?{position:"fixed",top:k>0?t.props.relative?h.offsetTop-h.offsetParent.scrollTop:0:k,left:D.left,width:D.width}:{};t.props.disableHardwareAcceleration||(T.transform="translateZ(0)"),t.setState({isSticky:s,wasSticky:S,distanceFromTop:d,distanceFromBottom:l,calculatedHeight:g,style:T})},o),J(t,i)}return Se(e,[{key:"componentWillMount",value:function(){if(!this.context.subscribe)throw new TypeError("Expected Sticky to be mounted within StickyContainer");this.context.subscribe(this.handleContainerEvent)}},{key:"componentWillUnmount",value:function(){this.context.unsubscribe(this.handleContainerEvent)}},{key:"componentDidUpdate",value:function(){this.placeholder.style.paddingBottom=this.props.disableCompensation?0:(this.state.isSticky?this.state.calculatedHeight:0)+"px"}},{key:"render",value:function(){var o=this,t=F.default.cloneElement(this.props.children({isSticky:this.state.isSticky,wasSticky:this.state.wasSticky,distanceFromTop:this.state.distanceFromTop,distanceFromBottom:this.state.distanceFromBottom,calculatedHeight:this.state.calculatedHeight,style:this.state.style}),{ref:function(c){o.content=Oe.default.findDOMNode(c)}});return F.default.createElement("div",null,F.default.createElement("div",{ref:function(c){return o.placeholder=c}}),t)}}]),e}(re.Component);M.propTypes={topOffset:b.default.number,bottomOffset:b.default.number,relative:b.default.bool,children:b.default.func.isRequired};M.defaultProps={relative:!1,topOffset:0,bottomOffset:0,disableCompensation:!1,disableHardwareAcceleration:!1};M.contextTypes={subscribe:b.default.func,unsubscribe:b.default.func,getParent:b.default.func};A.default=M;var W={},C={exports:{}},P={exports:{}};(function(){var n,e,r,o,t,i;typeof performance<"u"&&performance!==null&&performance.now?P.exports=function(){return performance.now()}:typeof process<"u"&&process!==null&&process.hrtime?(P.exports=function(){return(n()-t)/1e6},e=process.hrtime,n=function(){var c;return c=e(),c[0]*1e9+c[1]},o=n(),i=process.uptime()*1e9,t=o-i):Date.now?(P.exports=function(){return Date.now()-r},r=Date.now()):(P.exports=function(){return new Date().getTime()-r},r=new Date().getTime())}).call(X);var Re=P.exports,$e=Re,m=typeof window>"u"?X:window,$=["moz","webkit"],w="AnimationFrame",j=m["request"+w],E=m["cancel"+w]||m["cancelRequest"+w];for(var O=0;!j&&O<$.length;O++)j=m[$[O]+"Request"+w],E=m[$[O]+"Cancel"+w]||m[$[O]+"CancelRequest"+w];if(!j||!E){var B=0,V=0,y=[],Me=1e3/60;j=function(n){if(y.length===0){var e=$e(),r=Math.max(0,Me-(e-B));B=r+e,setTimeout(function(){var o=y.slice(0);y.length=0;for(var t=0;t<o.length;t++)if(!o[t].cancelled)try{o[t].callback(B)}catch(i){setTimeout(function(){throw i},0)}},Math.round(r))}return y.push({handle:++V,callback:n,cancelled:!1}),V},E=function(n){for(var e=0;e<y.length;e++)y[e].handle===n&&(y[e].cancelled=!0)}}C.exports=function(n){return j.call(m,n)};C.exports.cancel=function(){E.apply(m,arguments)};C.exports.polyfill=function(n){n||(n=m),n.requestAnimationFrame=j,n.cancelAnimationFrame=E};var Ce=C.exports;Object.defineProperty(W,"__esModule",{value:!0});var Ne=Object.assign||function(n){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(n[o]=r[o])}return n},Fe=function(){function n(e,r){for(var o=0;o<r.length;o++){var t=r[o];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}return function(e,r,o){return r&&n(e.prototype,r),o&&n(e,o),e}}(),oe=Q,Be=q(oe),He=ne,H=q(He),Le=Ce,Y=q(Le);function q(n){return n&&n.__esModule?n:{default:n}}function ze(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function Z(n,e){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:n}function Ae(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);n.prototype=Object.create(e&&e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(n,e):n.__proto__=e)}var ae=function(n){Ae(e,n);function e(){var r,o,t,i;ze(this,e);for(var c=arguments.length,p=Array(c),u=0;u<c;u++)p[u]=arguments[u];return i=(o=(t=Z(this,(r=e.__proto__||Object.getPrototypeOf(e)).call.apply(r,[this].concat(p))),t),t.events=["resize","scroll","touchstart","touchmove","touchend","pageshow","load"],t.subscribers=[],t.rafHandle=null,t.subscribe=function(f){t.subscribers=t.subscribers.concat(f)},t.unsubscribe=function(f){t.subscribers=t.subscribers.filter(function(d){return d!==f})},t.notifySubscribers=function(f){if(!t.framePending){var d=f.currentTarget;t.rafHandle=(0,Y.default)(function(){t.framePending=!1;var l=t.node.getBoundingClientRect(),v=l.top,h=l.bottom;t.subscribers.forEach(function(x){return x({distanceFromTop:v,distanceFromBottom:h,eventSource:d===window?document.body:t.node})})}),t.framePending=!0}},t.getParent=function(){return t.node},o),Z(t,i)}return Fe(e,[{key:"getChildContext",value:function(){return{subscribe:this.subscribe,unsubscribe:this.unsubscribe,getParent:this.getParent}}},{key:"componentDidMount",value:function(){var o=this;this.events.forEach(function(t){return window.addEventListener(t,o.notifySubscribers)})}},{key:"componentWillUnmount",value:function(){var o=this;this.rafHandle&&(Y.default.cancel(this.rafHandle),this.rafHandle=null),this.events.forEach(function(t){return window.removeEventListener(t,o.notifySubscribers)})}},{key:"render",value:function(){var o=this;return Be.default.createElement("div",Ne({},this.props,{ref:function(i){return o.node=i},onScroll:this.notifySubscribers,onTouchStart:this.notifySubscribers,onTouchMove:this.notifySubscribers,onTouchEnd:this.notifySubscribers}))}}]),e}(oe.PureComponent);ae.childContextTypes={subscribe:H.default.func,unsubscribe:H.default.func,getParent:H.default.func};W.default=ae;Object.defineProperty(_,"__esModule",{value:!0});var ie=_.StickyContainer=le=_.Sticky=void 0,Ue=A,se=ce(Ue),We=W,qe=ce(We);function ce(n){return n&&n.__esModule?n:{default:n}}var le=_.Sticky=se.default;ie=_.StickyContainer=qe.default;_.default=se.default;const{Link:Ie}=ge,{confirm:Ke}=ke,Ge=({list:n,defaultChapter:e,bookId:r,title:o})=>{var g,k,S;const{get:t,delete:i}=fe(),{isUser:c}=te(),p=(k=(g=n.filter(s=>s.book_id===r&&s.chapter===e))==null?void 0:g[0])==null?void 0:k.slug,u=s=>{t(route("chapters.show",s))},f=s=>{var I;const T=(I=n.filter(K=>K.book_id===r&&K.chapter===s))==null?void 0:I[0];T&&u(T.slug)},d=n.map(s=>({label:`Chapter ${s.chapter} : ${s.title}`,value:s.slug,disabled:s.chapter===e})),l=((S=n.filter(s=>s.chapter===e))==null?void 0:S[0])||{},v=Math.max(...n.map(s=>s.chapter)),h=e-1<=0,x=e+1>v,D=()=>{Ke({title:"Delete Chapter",icon:a.jsx(pe,{}),content:"คุณต้องการลบ Chapter นี้หรือไม่?",okText:"Yes",okType:"danger",okButtonProps:{type:"primary"},cancelText:"No",onOk(){i(route("chapters.destroy",l.id))},onCancel(){}})},N=[{key:1,label:"Title",children:a.jsx(z,{href:route("books.show",r),children:a.jsx(Ie,{children:o})})},{key:1,label:`Chapter ${l.chapter}`,children:l.title}];return a.jsx(he,{title:"Page Menu",children:a.jsxs("div",{className:"p-4",children:[a.jsx(_e,{column:1,items:N,size:"small"}),a.jsxs(me.Compact,{className:"m-4",children:[a.jsx(R,{disabled:h,onClick:()=>f(e-1),icon:a.jsx(ve,{}),type:"primary",size:"large"}),a.jsx(ye,{defaultValue:p,style:{width:"240px"},options:d,onChange:u,size:"large"}),a.jsx(R,{disabled:x,onClick:()=>f(e+1),icon:a.jsx(be,{}),iconPosition:"end",type:"primary",size:"large"})]}),c(l.user_id)?a.jsxs(ee,{justify:"center",wrap:!0,gap:"small",children:[a.jsx(z,{href:route("chapters.edit",l.slug),children:a.jsx(R,{size:"large",type:"primary",icon:a.jsx(xe,{}),children:"Edit"})}),a.jsx(R,{size:"large",onClick:D,type:"primary",danger:!0,icon:a.jsx(je,{}),children:"Delete"})]}):null]})})},L=Ge;function tt({user:n,list:e,defaultChapter:r,bookId:o,children:t,title:i}){const{isAuth:c}=te();return a.jsx("div",{className:"min-h-screen",children:a.jsxs(ie,{children:[a.jsx(le,{topOffset:80,children:({style:p})=>a.jsx("nav",{style:p,className:"bg-primary border-b border-primary z-10",children:a.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:a.jsxs("div",{className:"flex justify-between h-16",children:[a.jsx("div",{className:"flex",children:a.jsx("div",{className:"shrink-0 flex items-center",children:a.jsx(z,{href:"/",children:a.jsx(de,{size:36,className:"block h-9 w-auto fill-current text-gray-800 dark:text-gray-200"})})})}),a.jsx("div",{className:"hidden sm:flex sm:items-center space-x-2 sm:-my-px sm:ms-6",children:c?a.jsxs(a.Fragment,{children:[a.jsx(L,{list:e,bookId:o,defaultChapter:r,title:i}),a.jsx(G,{})]}):a.jsx(L,{list:e,bookId:o,defaultChapter:r,title:i})}),a.jsxs(ee,{gap:"small",className:"items-center sm:hidden",children:[a.jsx(L,{list:e,bookId:o,defaultChapter:r,title:i}),a.jsx(G,{})]})]})})})}),a.jsx("main",{className:"min-h-screen",children:t}),a.jsx(we,{})]})})}export{tt as M};
