import{r as o,G as Z,H as I,I as xe,J as $e,N as Se,L as q,ax as be,ab as ye,ae as H,F as we,j as d,Y as Le}from"./app-87RjO40g.js";import{a as je,b as Ee,F as Be}from"./ApplicationLogo-FuT3mxrP.js";import{C as Pe,F as U,S as Ie}from"./FooterLayout-B93Em4Pz.js";import{I as Ne}from"./index-DcOOoy3h.js";import{e as Te}from"./index-pTK18D2Z.js";import{g as Ae,s as ze}from"./scrollTo-DcR3TzMy.js";import{A as Oe}from"./index-D3KqQmYl.js";import{M as _e}from"./MangaLayout-BrPXsjcJ.js";import{F as Re}from"./index-BjDLTnI3.js";/* empty css            */import"./EyeOutlined-BxPtR7Ut.js";import"./addEventListener-9i96yuUz.js";import"./index-BKNjMPK8.js";import"./index-BC9pYv4w.js";import"./DeleteOutlined-gAM1sD6I.js";import"./index-BPQ6ky5x.js";const ee=o.createContext(void 0),te=t=>{const{href:e,title:i,prefixCls:a,children:l,className:s,target:c,replace:h}=t,b=o.useContext(ee),{registerLink:y,unregisterLink:w,scrollTo:g,onClick:L,activeLink:v,direction:N}=b||{};o.useEffect(()=>(y==null||y(e),()=>{w==null||w(e)}),[e]);const j=k=>{L==null||L(k,{title:i,href:e}),g==null||g(e),h&&(k.preventDefault(),window.location.replace(e))},{getPrefixCls:E}=o.useContext(Z),p=E("anchor",a),T=v===e,$=I(`${p}-link`,s,{[`${p}-link-active`]:T}),A=I(`${p}-link-title`,{[`${p}-link-title-active`]:T});return o.createElement("div",{className:$},o.createElement("a",{className:A,href:e,title:typeof i=="string"?i:"",target:c,onClick:j},i),N!=="horizontal"?l:null)},Me=t=>{const{componentCls:e,holderOffsetBlock:i,motionDurationSlow:a,lineWidthBold:l,colorPrimary:s,lineType:c,colorSplit:h,calc:b}=t;return{[`${e}-wrapper`]:{marginBlockStart:b(i).mul(-1).equal(),paddingBlockStart:i,[e]:Object.assign(Object.assign({},Se(t)),{position:"relative",paddingInlineStart:l,[`${e}-link`]:{paddingBlock:t.linkPaddingBlock,paddingInline:`${q(t.linkPaddingInlineStart)} 0`,"&-title":Object.assign(Object.assign({},be),{position:"relative",display:"block",marginBlockEnd:t.anchorTitleBlock,color:t.colorText,transition:`all ${t.motionDurationSlow}`,"&:only-child":{marginBlockEnd:0}}),[`&-active > ${e}-link-title`]:{color:t.colorPrimary},[`${e}-link`]:{paddingBlock:t.anchorPaddingBlockSecondary}}}),[`&:not(${e}-wrapper-horizontal)`]:{[e]:{"&::before":{position:"absolute",insetInlineStart:0,top:0,height:"100%",borderInlineStart:`${q(l)} ${c} ${h}`,content:'" "'},[`${e}-ink`]:{position:"absolute",insetInlineStart:0,display:"none",transform:"translateY(-50%)",transition:`top ${a} ease-in-out`,width:l,backgroundColor:s,[`&${e}-ink-visible`]:{display:"inline-block"}}}},[`${e}-fixed ${e}-ink ${e}-ink`]:{display:"none"}}}},De=t=>{const{componentCls:e,motionDurationSlow:i,lineWidthBold:a,colorPrimary:l}=t;return{[`${e}-wrapper-horizontal`]:{position:"relative","&::before":{position:"absolute",left:{_skip_check_:!0,value:0},right:{_skip_check_:!0,value:0},bottom:0,borderBottom:`${q(t.lineWidth)} ${t.lineType} ${t.colorSplit}`,content:'" "'},[e]:{overflowX:"scroll",position:"relative",display:"flex",scrollbarWidth:"none","&::-webkit-scrollbar":{display:"none"},[`${e}-link:first-of-type`]:{paddingInline:0},[`${e}-ink`]:{position:"absolute",bottom:0,transition:`left ${i} ease-in-out, width ${i} ease-in-out`,height:a,backgroundColor:l}}}}},Fe=t=>({linkPaddingBlock:t.paddingXXS,linkPaddingInlineStart:t.padding}),He=xe("Anchor",t=>{const{fontSize:e,fontSizeLG:i,paddingXXS:a,calc:l}=t,s=$e(t,{holderOffsetBlock:a,anchorPaddingBlockSecondary:l(a).div(2).equal(),anchorTitleBlock:l(e).div(14).mul(3).equal(),anchorBallSize:l(i).div(2).equal()});return[Me(s),De(s)]},Fe);function qe(){return window}function K(t,e){if(!t.getClientRects().length)return 0;const i=t.getBoundingClientRect();return i.width||i.height?e===window?i.top-t.ownerDocument.documentElement.clientTop:i.top-e.getBoundingClientRect().top:i.top}const Q=/#([\S ]+)$/,We=t=>{var e;const{rootClassName:i,prefixCls:a,className:l,style:s,offsetTop:c,affix:h=!0,showInkInFixed:b=!1,children:y,items:w,direction:g="vertical",bounds:L,targetOffset:v,onClick:N,onChange:j,getContainer:E,getCurrentAnchor:p,replace:T}=t,[$,A]=o.useState([]),[k,oe]=o.useState(null),z=o.useRef(k),W=o.useRef(null),O=o.useRef(null),_=o.useRef(!1),{direction:ie,anchor:S,getTargetContainer:re,getPrefixCls:se}=o.useContext(Z),m=se("anchor",a),X=ye(m),[ae,le,ce]=He(m,X),B=(e=E??re)!==null&&e!==void 0?e:qe,R=JSON.stringify($),de=H(n=>{$.includes(n)||A(r=>[].concat(we(r),[n]))}),ue=H(n=>{$.includes(n)&&A(r=>r.filter(f=>f!==n))}),pe=()=>{var n;const r=(n=W.current)===null||n===void 0?void 0:n.querySelector(`.${m}-link-title-active`);if(r&&O.current){const{style:f}=O.current,u=g==="horizontal";f.top=u?"":`${r.offsetTop+r.clientHeight/2}px`,f.height=u?"":`${r.clientHeight}px`,f.left=u?`${r.offsetLeft}px`:"",f.width=u?`${r.clientWidth}px`:"",u&&Te(r,{scrollMode:"if-needed",block:"nearest"})}},fe=function(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:5;const u=[],F=B();return n.forEach(x=>{const C=Q.exec(x==null?void 0:x.toString());if(!C)return;const P=document.getElementById(C[1]);if(P){const Y=K(P,F);Y<=r+f&&u.push({link:x,top:Y})}}),u.length?u.reduce((C,P)=>P.top>C.top?P:C).link:""},M=H(n=>{if(z.current===n)return;const r=typeof p=="function"?p(n):n;oe(r),z.current=r,j==null||j(n)}),D=o.useCallback(()=>{if(_.current)return;const n=fe($,v!==void 0?v:c||0,L);M(n)},[R,v,c]),V=o.useCallback(n=>{M(n);const r=Q.exec(n);if(!r)return;const f=document.getElementById(r[1]);if(!f)return;const u=B(),F=Ae(u),x=K(f,u);let C=F+x;C-=v!==void 0?v:c||0,_.current=!0,ze(C,{getContainer:B,callback(){_.current=!1}})},[v,c]),ge=I(le,ce,X,i,`${m}-wrapper`,{[`${m}-wrapper-horizontal`]:g==="horizontal",[`${m}-rtl`]:ie==="rtl"},l,S==null?void 0:S.className),me=I(m,{[`${m}-fixed`]:!h&&!b}),he=I(`${m}-ink`,{[`${m}-ink-visible`]:k}),ve=Object.assign(Object.assign({maxHeight:c?`calc(100vh - ${c}px)`:"100vh"},S==null?void 0:S.style),s),G=n=>Array.isArray(n)?n.map(r=>o.createElement(te,Object.assign({replace:T},r,{key:r.key}),g==="vertical"&&G(r.children))):null,J=o.createElement("div",{ref:W,className:ge,style:ve},o.createElement("div",{className:me},o.createElement("span",{className:he,ref:O}),"items"in t?G(w):y));o.useEffect(()=>{const n=B();return D(),n==null||n.addEventListener("scroll",D),()=>{n==null||n.removeEventListener("scroll",D)}},[R]),o.useEffect(()=>{typeof p=="function"&&M(p(z.current||""))},[p]),o.useEffect(()=>{pe()},[g,p,R,k]);const ke=o.useMemo(()=>({registerLink:de,unregisterLink:ue,scrollTo:V,activeLink:k,onClick:N,direction:g}),[k,N,V,g]),Ce=h&&typeof h=="object"?h:void 0;return ae(o.createElement(ee.Provider,{value:ke},h?o.createElement(Oe,Object.assign({offsetTop:c,target:B},Ce),J):J))},ne=We;ne.Link=te;const Xe=({list:t})=>{const[e,i]=o.useState(1),a=t.slice(0,e).map(s=>({key:`page-${s.page}`,href:`#page-${s.page}`,title:" "})),l=o.useCallback(s=>{const c=parseInt(s.slice(6));c>e-5&&i(c+5)},[e]);return d.jsxs(Pe,{children:[d.jsx(U,{span:23,children:t.slice(0,e).map(s=>d.jsx("div",{id:`page-${s.page}`,className:"text-center",children:s.page<e?d.jsx(Ne,{preview:!1,alt:`Page ${s.page}`,src:je(`storage/chapter-pages/${s.img_url}`),fallback:Ee,className:"w-screen h-screen object-cover object-center",loading:"lazy"}):d.jsx(Be,{justify:"center",align:"middle",style:{height:Math.floor(s.height/2)},children:d.jsx(Ie,{size:"large"})})},s.id))}),d.jsx(U,{className:"hidden sm:block",span:1,children:d.jsx(ne,{replace:!0,offsetTop:70,items:a,onChange:l})})]})},Ve=Xe;function ct({auth:t,chapter:e,allChapterList:i}){var a;return d.jsxs(_e,{title:((a=e==null?void 0:e.book)==null?void 0:a.title)||"",user:t.user,bookId:e.book_id,defaultChapter:e.chapter,list:i||[],children:[d.jsx(Le,{title:`Chapter ${e.chapter} : ${e.title}`}),d.jsxs("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8 pb-12",children:[d.jsx(Ve,{list:e.pages||[]}),d.jsx(Re.BackTop,{})]})]})}export{ct as default};
