import{r as K,ai as de,c as X,W as he,j as a,aD as W,B as D,aQ as me}from"./app-DpMSqZno.js";import{F as ee,A as ye}from"./ApplicationLogo-9L4KVSOt.js";import{u as te,H as ve,q as be,F as ge,r as xe,b as _e,t as we,T as Te,N as V,G as ke}from"./FooterLayout-B7IU0h2A.js";import{D as Se}from"./index-Bd7P9pcN.js";import{R as je}from"./DeleteOutlined-BeyAe15s.js";import{M as Oe}from"./index-DsPkJ3u_.js";var ne={exports:{}},Pe="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",Ee=Pe,Re=Ee;function re(){}function oe(){}oe.resetWarningCache=re;var De=function(){function t(o,n,i,s,p,u){if(u!==Re){var l=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw l.name="Invariant Violation",l}}t.isRequired=t;function e(){return t}var r={array:t,bigint:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:e,element:t,elementType:t,instanceOf:e,node:t,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:oe,resetWarningCache:re};return r.PropTypes=r,r};ne.exports=De();var ae=ne.exports,w={},A={};Object.defineProperty(A,"__esModule",{value:!0});var $e=function(){function t(e,r){for(var o=0;o<r.length;o++){var n=r[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,r,o){return r&&t(e.prototype,r),o&&t(e,o),e}}(),ie=K,M=z(ie),Fe=de,Ne=z(Fe),Ce=ae,b=z(Ce);function z(t){return t&&t.__esModule?t:{default:t}}function Me(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Y(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:t}function Be(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var F=function(t){Be(e,t);function e(){var r,o,n,i;Me(this,e);for(var s=arguments.length,p=Array(s),u=0;u<s;u++)p[u]=arguments[u];return i=(o=(n=Y(this,(r=e.__proto__||Object.getPrototypeOf(e)).call.apply(r,[this].concat(p))),n),n.state={isSticky:!1,wasSticky:!1,style:{}},n.handleContainerEvent=function(l){var d=l.distanceFromTop,f=l.distanceFromBottom,y=l.eventSource,h=n.context.getParent(),g=!1;n.props.relative&&(g=y!==h,d=-(y.scrollTop+y.offsetTop)+n.placeholder.offsetTop);var R=n.placeholder.getBoundingClientRect(),C=n.content.getBoundingClientRect(),x=C.height,k=f-n.props.bottomOffset-x,S=!!n.state.isSticky,c=g?S:d<=-n.props.topOffset&&f>-n.props.bottomOffset;f=(n.props.relative?h.scrollHeight-h.scrollTop:f)-x;var j=c?{position:"fixed",top:k>0?n.props.relative?h.offsetTop-h.offsetParent.scrollTop:0:k,left:R.left,width:R.width}:{};n.props.disableHardwareAcceleration||(j.transform="translateZ(0)"),n.setState({isSticky:c,wasSticky:S,distanceFromTop:d,distanceFromBottom:f,calculatedHeight:x,style:j})},o),Y(n,i)}return $e(e,[{key:"componentWillMount",value:function(){if(!this.context.subscribe)throw new TypeError("Expected Sticky to be mounted within StickyContainer");this.context.subscribe(this.handleContainerEvent)}},{key:"componentWillUnmount",value:function(){this.context.unsubscribe(this.handleContainerEvent)}},{key:"componentDidUpdate",value:function(){this.placeholder.style.paddingBottom=this.props.disableCompensation?0:(this.state.isSticky?this.state.calculatedHeight:0)+"px"}},{key:"render",value:function(){var o=this,n=M.default.cloneElement(this.props.children({isSticky:this.state.isSticky,wasSticky:this.state.wasSticky,distanceFromTop:this.state.distanceFromTop,distanceFromBottom:this.state.distanceFromBottom,calculatedHeight:this.state.calculatedHeight,style:this.state.style}),{ref:function(s){o.content=Ne.default.findDOMNode(s)}});return M.default.createElement("div",null,M.default.createElement("div",{ref:function(s){return o.placeholder=s}}),n)}}]),e}(ie.Component);F.propTypes={topOffset:b.default.number,bottomOffset:b.default.number,relative:b.default.bool,children:b.default.func.isRequired};F.defaultProps={relative:!1,topOffset:0,bottomOffset:0,disableCompensation:!1,disableHardwareAcceleration:!1};F.contextTypes={subscribe:b.default.func,unsubscribe:b.default.func,getParent:b.default.func};A.default=F;var U={},N={exports:{}},P={exports:{}};(function(){var t,e,r,o,n,i;typeof performance<"u"&&performance!==null&&performance.now?P.exports=function(){return performance.now()}:typeof process<"u"&&process!==null&&process.hrtime?(P.exports=function(){return(t()-n)/1e6},e=process.hrtime,t=function(){var s;return s=e(),s[0]*1e9+s[1]},o=t(),i=process.uptime()*1e9,n=o-i):Date.now?(P.exports=function(){return Date.now()-r},r=Date.now()):(P.exports=function(){return new Date().getTime()-r},r=new Date().getTime())}).call(X);var He=P.exports,Le=He,m=typeof window>"u"?X:window,$=["moz","webkit"],_="AnimationFrame",T=m["request"+_],E=m["cancel"+_]||m["cancelRequest"+_];for(var O=0;!T&&O<$.length;O++)T=m[$[O]+"Request"+_],E=m[$[O]+"Cancel"+_]||m[$[O]+"CancelRequest"+_];if(!T||!E){var B=0,Q=0,v=[],We=1e3/60;T=function(t){if(v.length===0){var e=Le(),r=Math.max(0,We-(e-B));B=r+e,setTimeout(function(){var o=v.slice(0);v.length=0;for(var n=0;n<o.length;n++)if(!o[n].cancelled)try{o[n].callback(B)}catch(i){setTimeout(function(){throw i},0)}},Math.round(r))}return v.push({handle:++Q,callback:t,cancelled:!1}),Q},E=function(t){for(var e=0;e<v.length;e++)v[e].handle===t&&(v[e].cancelled=!0)}}N.exports=function(t){return T.call(m,t)};N.exports.cancel=function(){E.apply(m,arguments)};N.exports.polyfill=function(t){t||(t=m),t.requestAnimationFrame=T,t.cancelAnimationFrame=E};var Ae=N.exports;Object.defineProperty(U,"__esModule",{value:!0});var ze=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(t[o]=r[o])}return t},Ue=function(){function t(e,r){for(var o=0;o<r.length;o++){var n=r[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,r,o){return r&&t(e.prototype,r),o&&t(e,o),e}}(),se=K,qe=q(se),Ie=ae,H=q(Ie),Ge=Ae,Z=q(Ge);function q(t){return t&&t.__esModule?t:{default:t}}function Ve(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function J(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:t}function Ye(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var ce=function(t){Ye(e,t);function e(){var r,o,n,i;Ve(this,e);for(var s=arguments.length,p=Array(s),u=0;u<s;u++)p[u]=arguments[u];return i=(o=(n=J(this,(r=e.__proto__||Object.getPrototypeOf(e)).call.apply(r,[this].concat(p))),n),n.events=["resize","scroll","touchstart","touchmove","touchend","pageshow","load"],n.subscribers=[],n.rafHandle=null,n.subscribe=function(l){n.subscribers=n.subscribers.concat(l)},n.unsubscribe=function(l){n.subscribers=n.subscribers.filter(function(d){return d!==l})},n.notifySubscribers=function(l){if(!n.framePending){var d=l.currentTarget;n.rafHandle=(0,Z.default)(function(){n.framePending=!1;var f=n.node.getBoundingClientRect(),y=f.top,h=f.bottom;n.subscribers.forEach(function(g){return g({distanceFromTop:y,distanceFromBottom:h,eventSource:d===window?document.body:n.node})})}),n.framePending=!0}},n.getParent=function(){return n.node},o),J(n,i)}return Ue(e,[{key:"getChildContext",value:function(){return{subscribe:this.subscribe,unsubscribe:this.unsubscribe,getParent:this.getParent}}},{key:"componentDidMount",value:function(){var o=this;this.events.forEach(function(n){return window.addEventListener(n,o.notifySubscribers)})}},{key:"componentWillUnmount",value:function(){var o=this;this.rafHandle&&(Z.default.cancel(this.rafHandle),this.rafHandle=null),this.events.forEach(function(n){return window.removeEventListener(n,o.notifySubscribers)})}},{key:"render",value:function(){var o=this;return qe.default.createElement("div",ze({},this.props,{ref:function(i){return o.node=i},onScroll:this.notifySubscribers,onTouchStart:this.notifySubscribers,onTouchMove:this.notifySubscribers,onTouchEnd:this.notifySubscribers}))}}]),e}(se.PureComponent);ce.childContextTypes={subscribe:H.default.func,unsubscribe:H.default.func,getParent:H.default.func};U.default=ce;Object.defineProperty(w,"__esModule",{value:!0});var le=w.StickyContainer=pe=w.Sticky=void 0,Qe=A,ue=fe(Qe),Ze=U,Je=fe(Ze);function fe(t){return t&&t.__esModule?t:{default:t}}var pe=w.Sticky=ue.default;le=w.StickyContainer=Je.default;w.default=ue.default;const{Link:Ke}=Te,{confirm:Xe}=Oe,et=({list:t,defaultChapter:e,bookId:r,title:o})=>{var x,k,S;const{get:n,delete:i}=he(),{isUser:s}=te(),p=(k=(x=t.filter(c=>c.book_id===r&&c.chapter===e))==null?void 0:x[0])==null?void 0:k.slug,u=c=>{n(route("chapters.show",c))},l=c=>{var I;const j=(I=t.filter(G=>G.book_id===r&&G.chapter===c))==null?void 0:I[0];j&&u(j.slug)},d=t.map(c=>({label:`Chapter ${c.chapter} : ${c.title}`,value:c.slug,disabled:c.chapter===e})),f=((S=t.filter(c=>c.chapter===e))==null?void 0:S[0])||{},y=Math.max(...t.map(c=>c.chapter)),h=e-1<=0,g=e+1>y,R=()=>{Xe({title:"Delete Chapter",icon:a.jsx(me,{}),content:"คุณต้องการลบ Chapter นี้หรือไม่?",okText:"Yes",okType:"danger",okButtonProps:{type:"primary"},cancelText:"No",onOk(){i(route("chapters.destroy",f.id))},onCancel(){}})},C=[{key:1,label:"Title",children:a.jsx(W,{href:route("books.show",r),children:a.jsx(Ke,{children:o})})},{key:1,label:`Chapter ${f.chapter}`,children:f.title}];return a.jsx(ve,{title:"Page Menu",children:a.jsxs("div",{className:"p-4",children:[a.jsx(Se,{column:1,items:C,size:"small"}),a.jsxs(be.Compact,{className:"m-4",children:[a.jsx(D,{disabled:h,onClick:()=>l(e-1),icon:a.jsx(ge,{}),type:"primary",size:"large"}),a.jsx(xe,{defaultValue:p,style:{width:"240px"},options:d,onChange:u,size:"large"}),a.jsx(D,{disabled:g,onClick:()=>l(e+1),icon:a.jsx(_e,{}),iconPosition:"end",type:"primary",size:"large"})]}),s(f.user_id)?a.jsxs(ee,{justify:"center",wrap:!0,gap:"small",children:[a.jsx(W,{href:route("chapters.edit",f.slug),children:a.jsx(D,{size:"large",type:"primary",icon:a.jsx(we,{}),children:"Edit"})}),a.jsx(D,{size:"large",onClick:R,type:"primary",danger:!0,icon:a.jsx(je,{}),children:"Delete"})]}):null]})})},L=et;function st({user:t,list:e,defaultChapter:r,bookId:o,children:n,title:i}){const{isAuth:s}=te();return a.jsx("div",{className:"min-h-screen bg-gray-100 dark:bg-gray-900",children:a.jsxs(le,{children:[a.jsx(pe,{topOffset:80,children:({style:p})=>a.jsx("nav",{style:p,className:"bg-white dark:bg-gray-800 border-b border-gray-100 dark:border-gray-700 z-10",children:a.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:a.jsxs("div",{className:"flex justify-between h-16",children:[a.jsx("div",{className:"flex",children:a.jsx("div",{className:"shrink-0 flex items-center",children:a.jsx(W,{href:"/",children:a.jsx(ye,{size:36,className:"block h-9 w-auto fill-current text-gray-800 dark:text-gray-200"})})})}),a.jsx("div",{className:"hidden sm:flex sm:items-center space-x-2 sm:-my-px sm:ms-6",children:s?a.jsxs(a.Fragment,{children:[a.jsx(L,{list:e,bookId:o,defaultChapter:r,title:i}),a.jsx(V,{})]}):a.jsx(L,{list:e,bookId:o,defaultChapter:r,title:i})}),a.jsxs(ee,{gap:"small",className:"items-center sm:hidden",children:[a.jsx(L,{list:e,bookId:o,defaultChapter:r,title:i}),a.jsx(V,{})]})]})})})}),a.jsx("main",{className:"min-h-screen",children:n}),a.jsx(ke,{})]})})}export{st as M};
