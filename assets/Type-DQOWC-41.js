import{r as g,X as D,y as M,ac as N,ad as T,ae as E,af as z,ag as O,j as a,a9 as H,B,Y as $}from"./app-BMCNW8jw.js";import{A as W}from"./AuthenticatedLayout-zgmGGxiw.js";import{B as X}from"./BookList-U5NfsT0B.js";import{b as d,c as Y,d as v,u as _,D as q}from"./FooterLayout-Bsjv7eYk.js";import{C as G}from"./CategoryFilter-5tb-Xm-J.js";import{R as J}from"./PlusOutlined-BO4X4D1A.js";import{F as K}from"./ApplicationLogo-Cg6DUfms.js";import{F as Q}from"./index-V_S9f0iW.js";import"./index-8ViR2Fpo.js";import"./index-BPH_3ySU.js";import"./EyeOutlined-DSXNn0z0.js";import"./addEventListener-CYrrB4rT.js";import"./scrollTo-BbMOu6OJ.js";var U={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M909.1 209.3l-56.4 44.1C775.8 155.1 656.2 92 521.9 92 290 92 102.3 279.5 102 511.5 101.7 743.7 289.8 932 521.9 932c181.3 0 335.8-115 394.6-276.1 1.5-4.2-.7-8.9-4.9-10.3l-56.7-19.5a8 8 0 00-10.1 4.8c-1.8 5-3.8 10-5.9 14.9-17.3 41-42.1 77.8-73.7 109.4A344.77 344.77 0 01655.9 829c-42.3 17.9-87.4 27-133.8 27-46.5 0-91.5-9.1-133.8-27A341.5 341.5 0 01279 755.2a342.16 342.16 0 01-73.7-109.4c-17.9-42.4-27-87.4-27-133.9s9.1-91.5 27-133.9c17.3-41 42.1-77.8 73.7-109.4 31.6-31.6 68.4-56.4 109.3-73.8 42.3-17.9 87.4-27 133.8-27 46.5 0 91.5 9.1 133.8 27a341.5 341.5 0 01109.3 73.8c9.9 9.9 19.2 20.4 27.8 31.4l-60.2 47a8 8 0 003 14.1l175.6 43c5 1.2 9.9-2.6 9.9-7.7l.8-180.9c-.1-6.6-7.8-10.3-13-6.2z"}}]},name:"reload",theme:"outlined"},V=function(p,u){return g.createElement(D,M({},p,{ref:u,icon:U}))},Z=g.forwardRef(V);const ee=({key:o,flash:p})=>{const{message:u}=N.useApp(),y=d(e=>{var t,s;return(s=(t=e.bookReducer.keys)==null?void 0:t[o])==null?void 0:s.isLoading}),x=d(e=>{var t,s;return(s=(t=e.bookReducer.keys)==null?void 0:t[o])==null?void 0:s.isFetch}),C=d(e=>{var t,s;return(s=(t=e.bookReducer.keys)==null?void 0:t[o])==null?void 0:s.error}),n=d(e=>{var t,s;return(s=(t=e.bookReducer.keys)==null?void 0:t[o])==null?void 0:s.filters.categoryIds}),c=d(e=>{var t,s;return(s=(t=e.bookReducer.keys)==null?void 0:t[o])==null?void 0:s.pagination}),i=d(e=>{var t,s;return(s=(t=e.bookReducer.keys)==null?void 0:t[o])==null?void 0:s.pages}),r=d(e=>{var t,s;return(s=(t=e.bookReducer.keys)==null?void 0:t[o])==null?void 0:s.pagination.page}),l=Y(),m=(n||[]).toString(),h=v(r),j=v(m),P=g.useMemo(()=>{let e=[];const t=(c==null?void 0:c.page)||1;for(let s=0;s<t;s++){const w=(i==null?void 0:i[s+1])||[];e=[...e,...w]}return e},[i]),b=h!==r&&h!==void 0,R=j!==m&&j!==void 0,k=!(i!=null&&i[r]);g.useEffect(()=>{p==="refetch"?(u.success("Success"),f({key:o,categoryIds:n,page:r||1})):x?b&&k?f({key:o,categoryIds:n,page:r||1}):R&&r!==1?L(1):R&&r===1&&f({key:o,categoryIds:n,page:r}):f({key:o,categoryIds:n,page:r||1})},[o,r,m,p]);const f=async e=>await l(T(e)),F=g.useCallback(e=>{l(E({key:o,categoryIds:e}))},[o]),I=g.useCallback(e=>{l(z({key:o,page:e}))},[o]),L=g.useCallback(e=>{l(O({key:o,page:e}))},[o]),A=P||[],S=(c==null?void 0:c.lastPage)||1;return{page:r,isLoading:y,isFetch:x,list:A,error:C,pagination:c,refetch:f,categoryIds:n||[],lastPage:S,setBookPage:I,setBookFilterCategory:F}},se={currentPage:1,pageSize:12,total:0};function fe(o){const p={...se,...o},{title:u,categories:y,type:x,flash:C}=p,{isRole:n}=_(),{list:c,isLoading:i,lastPage:r,page:l,setBookPage:m,categoryIds:h,setBookFilterCategory:j}=ee({key:x,flash:C.message}),P=()=>{m(l+1)},b=l>=r;return a.jsxs(W,{header:a.jsx("h2",{className:"font-semibold text-xl text-gray-800 dark:text-gray-200 leading-tight",children:u}),actions:n("writer")?a.jsx(H,{href:route("books.create"),children:a.jsx(B,{size:"small",type:"primary",icon:a.jsx(J,{}),children:"Create"})}):null,children:[a.jsx($,{title:u}),a.jsx("div",{className:"pt-4 pb-12",children:a.jsxs("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8",children:[a.jsx(G,{value:h,list:y,onChange:j}),a.jsx(q,{}),a.jsx(X,{list:c}),b?null:a.jsx(K,{className:"my-4",justify:"center",gap:"small",children:a.jsx(B,{type:"primary",onClick:P,icon:a.jsx(Z,{}),loading:i,disabled:b,children:"Load More"})}),a.jsx(Q.BackTop,{})]})})]})}export{fe as default};
