import{r as m,X as N,y as A,aT as D,aU as I,j as s,B as f,W as $,aD as F,aQ as _}from"./app-D676uEx3.js";import{a as k,d as E,F as v}from"./ApplicationLogo-BN6NjkgJ.js";import{m as h,n as H,u as M,s as R,R as z,C,q as O,t as S,T as P}from"./FooterLayout-B0yBxQk0.js";import{R as U}from"./HeartFilled-CcglIGm_.js";import{I as L}from"./index-CTGmEV-i.js";import{D as x}from"./index-B3EGFAYJ.js";import{R as q}from"./DeleteOutlined-Cb9AW-1q.js";import{M as Q}from"./index-DdADvNfm.js";var W={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M923 283.6a260.04 260.04 0 00-56.9-82.8 264.4 264.4 0 00-84-55.5A265.34 265.34 0 00679.7 125c-49.3 0-97.4 13.5-139.2 39-10 6.1-19.5 12.8-28.5 20.1-9-7.3-18.5-14-28.5-20.1-41.8-25.5-89.9-39-139.2-39-35.5 0-69.9 6.8-102.4 20.3-31.4 13-59.7 31.7-84 55.5a258.44 258.44 0 00-56.9 82.8c-13.9 32.3-21 66.6-21 101.9 0 33.3 6.8 68 20.3 103.3 11.3 29.5 27.5 60.1 48.2 91 32.8 48.9 77.9 99.9 133.9 151.6 92.8 85.7 184.7 144.9 188.6 147.3l23.7 15.2c10.5 6.7 24 6.7 34.5 0l23.7-15.2c3.9-2.5 95.7-61.6 188.6-147.3 56-51.7 101.1-102.7 133.9-151.6 20.7-30.9 37-61.5 48.2-91 13.5-35.3 20.3-70 20.3-103.3.1-35.3-7-69.6-20.9-101.9zM512 814.8S156 586.7 156 385.5C156 283.6 240.3 201 344.3 201c73.1 0 136.5 40.8 167.7 100.4C543.2 241.8 606.6 201 679.7 201c104 0 188.3 82.6 188.3 184.5 0 201.2-356 429.3-356 429.3z"}}]},name:"heart",theme:"outlined"},X=function(a,o){return m.createElement(N,A({},a,{ref:o,icon:W}))},Y=m.forwardRef(X);const G=({bookId:e,onFollow:a})=>{const o=h(n=>{var t,r;return(r=(t=n.bookFollowingReducer.keys)==null?void 0:t[e])==null?void 0:r.isLoading}),i=h(n=>{var t,r;return(r=(t=n.bookFollowingReducer.keys)==null?void 0:t[e])==null?void 0:r.isFetch}),l=h(n=>{var t,r;return(r=(t=n.bookFollowingReducer.keys)==null?void 0:t[e])==null?void 0:r.data}),d=h(n=>{var t,r;return(r=(t=n.bookFollowingReducer.keys)==null?void 0:t[e])==null?void 0:r.error}),c=H(),u=!!(l!=null&&l.is_following)||!1;m.useEffect(()=>{i||p({bookId:e})},[e]),m.useEffect(()=>{i&&a&&a(u?1:0)},[u]);const p=async n=>await c(D(n));return{isLoading:o,isFetch:i,isFollowing:u,data:l,error:d,onClickFollowing:n=>{c(I(n))},refetch:p}},J=e=>{const{bookId:a,onFollow:o,followCount:i}=e,{isFollowing:l,onClickFollowing:d,isFetch:c}=G({bookId:a,onFollow:o});return c?s.jsx(f,{type:l?"primary":"default",shape:"round",icon:l?s.jsx(U,{}):s.jsx(Y,{}),danger:!0,onClick:()=>d({bookId:a}),className:l?"hover:bg-transparent":"bg-transparent",children:i||null}):null},{Text:B}=P,{confirm:K}=Q,V=({book:e,isSuggest:a})=>{var j,w;const{isUser:o,isRole:i,isAuth:l}=M(),{delete:d}=$(),c=()=>{K({title:"Delete Book",icon:s.jsx(_,{}),content:"Are you sure delete this book?",okText:"Yes",okType:"danger",okButtonProps:{type:"primary"},cancelText:"No",onOk(){d(route("books.destroy",e.id))},onCancel(){}})},[u,p]=m.useState(0),g=e.status==="Published"?"success":"warning",n=((e==null?void 0:e.active_followings_count)||0)+u,t=[{key:3,label:"Description",children:s.jsx("pre",{children:s.jsx(B,{className:"text-wrap",children:e.synopsis})})}],r=[{key:3,label:"Tags",children:e.categories.map(y=>s.jsx(R,{children:y.name},y.id))}],T=[{key:1,label:"Author",children:s.jsx(F,{href:route("writer.mention",((j=e==null?void 0:e.user)==null?void 0:j.mention)||""),children:s.jsx(B,{children:((w=e==null?void 0:e.user)==null?void 0:w.name)||""})})},{key:2,label:"Status",children:s.jsx(R,{color:g,children:e.status})}];return s.jsx("div",{style:{borderRadius:10},className:"bg-slate-700 p-4",children:s.jsxs(z,{gutter:[16,16],children:[s.jsx(C,{md:6,sm:24,className:"text-center mx-auto",children:s.jsx(L,{preview:!1,alt:e.title,src:k(`storage/${e.img_url}`),fallback:E,style:{borderRadius:10}})}),s.jsxs(C,{md:18,sm:24,children:[s.jsxs(v,{vertical:!0,gap:"small",children:[s.jsx(x,{column:1,title:e.title,extra:o(e.user_id)&&!a?s.jsxs(O.Compact,{children:[s.jsx(F,{href:route("books.edit",e.id),children:s.jsx(f,{type:"primary",shape:"round",icon:s.jsx(S,{})})}),s.jsx(f,{shape:"round",onClick:c,type:"primary",danger:!0,icon:s.jsx(q,{})})]}):null,items:T}),s.jsx("div",{className:"hidden sm:block",children:s.jsx(x,{column:1,size:"small",items:t})}),s.jsx("div",{className:"sm:hidden block",children:s.jsx(x,{column:1,size:"small",layout:"vertical",items:t})}),s.jsx(x,{column:1,items:r})]}),l&&!a?s.jsx(v,{className:"my-4",wrap:!0,gap:"small",children:s.jsx(J,{followCount:n,bookId:e.id,onFollow:p})}):null]})]})})},le=V;export{le as B};
